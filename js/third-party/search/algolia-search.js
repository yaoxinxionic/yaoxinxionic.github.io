document.addEventListener("DOMContentLoaded",()=>{const{indexName:e,appID:a,apiKey:t,hits:i}=CONFIG.algolia;const n=algoliasearch(a,t).initIndex(e),s=document.querySelector(".search-input"),c=document.querySelector(".search-result-container"),l=e=>{var{title:a,excerpt:t,excerptStrip:s,contentStripTruncate:r}=e._highlightResult;let i=`<li><a href="${e.permalink}" class="search-result-title">${a.value}</a>`;a=t||s||r;return a&&a.value&&((t=document.createElement("div")).innerHTML=a.value,i+=`<a href="${e.permalink}"><p class="search-result">${t.textContent.substring(0,100)}...</p></a></li>`),i};let o=!1,u=null;const d=async(t,s=0)=>{if(o)u={searchText:t,page:s};else{o=!0;var e=Date.now(),r=await n.search(t,{page:s,attributesToRetrieve:["permalink"],attributesToHighlight:["title","excerpt","excerptStrip","contentStripTruncate"],hitsPerPage:i.per_page||10,highlightPreTag:'<mark class="search-keyword">',highlightPostTag:"</mark>"});if(0===r.nbHits)c.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>';else{e=CONFIG.i18n.hits_time.replace("${hits}",r.nbHits).replace("${time}",Date.now()-e);let a="";if(1<r.nbPages){a+='<nav class="pagination algolia-pagination">';for(let e=0;e<r.nbPages;e++)e===s?a+=`<span class="page-number current">${e+1}</span>`:a+=`<a class="page-number" href="#" data-index=${e}>${e+1}</a>`;a+="</nav>"}c.innerHTML=`<div class="search-stats">
          <span>${e}</span>
          <img src="${CONFIG.images}/logo-algolia-nebula-blue-full.svg" alt="Algolia">
        </div>
        <hr>
        <ul class="search-result-list">${r.hits.map(l).join("")}</ul>
        `+a,"object"==typeof pjax&&pjax.refresh(c),c.querySelectorAll(".page-number").forEach(a=>{a.addEventListener("click",async e=>{e.preventDefault(),await d(t,Number(a.dataset.index))})})}if(o=!1,null!==u&&(u.searchText!==t||u.page!==s)){const{searchText:t,page:s}=u;u=null,d(t,s)}}};var r=NexT.utils.debounce(async()=>{var e=s.value.trim();""===e?c.innerHTML='<div class="search-result-icon"><i class="fab fa-algolia fa-5x"></i></div>':await d(e,0)},500);s.addEventListener("input",r),document.querySelectorAll(".popup-trigger").forEach(e=>{e.addEventListener("click",()=>{document.body.classList.add("search-active"),setTimeout(()=>s.focus(),500)})});const p=()=>{document.body.classList.remove("search-active")};document.querySelector(".search-pop-overlay").addEventListener("click",e=>{e.target===document.querySelector(".search-pop-overlay")&&p()}),document.querySelector(".popup-btn-close").addEventListener("click",p),document.addEventListener("pjax:success",p),window.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),document.body.classList.add("search-active"),setTimeout(()=>s.focus(),500))}),window.addEventListener("keyup",e=>{"Escape"===e.key&&p()})});